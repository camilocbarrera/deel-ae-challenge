version: 2

models:
  - name: stg_globepay__acceptance_report
    description: "stg model globepay acceptance report - globepay acceptance report"
    columns:
      - name: surrogate_key
        description: "surrogate key column that It is made up of a combination of unique elements."
        tests:
          - not_null

      - name: external_ref
        description: "The card expiry year. Format: 4 digits. For example: 2020"
        tests:
          - unique
          - not_null
          - relationships:
              to: ref('stg_globepay__chargeback_report')
              field: external_ref

      - name: status
        description: "It is not specified in the API documentation, it always comes TRUE"
        tests:
          - not_null
          - accepted_values:
              values: [ true, false ]
      - name: source
        description: "Name of the payment platform, indicates the source that in this source will be GlobePay by default"
        tests:
          - not_null
          - accepted_values:
              values: [ 'GLOBALPAY' ]
      - name: ref
        description: "reference or unique identifier generated by a payment gateway in a specific event."
        tests: [ not_null ,unique ]
      - name: _date_time
        description: "The timestamp of the transaction"
        tests:
          - not_null
      - name: state
        description: "The binary state of the transaction. For example: Accepted or Declined."
        tests: [ not_null ]
      - name: cvv_provided
        description: "Boolean value that checks if the cvv was given in the transaction"
        tests:
          - not_null
          - accepted_values:
              values: [ true, false ]
      - name: amount
        description: "The amount that has been charged from the card."
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: -100
              inclusive: True

      - name: country
        description: "The two-character ISO country code of the card."
        tests:
          - accepted_values:
              values: [ 'US','MX','FR','CA','UK','AE' ]
      - name: currency
        description: "The two-character ISO country code of the card."
        tests:
          - accepted_values:
              values: [ 'USD','MXN','EUR','CAD','GBP','USD' ]
      - name: rates
        description: "The exchange rate used. Funds are settled to you in USD."
        tests:
          - not_null




  - name: stg_globepay__chargeback_report
    description: "stg  globepay chargeback report - globepay chargeback report"
    columns:
      - name: surrogate_key
        description: "surrogate key column that It is made up of a combination of unique elements."
        tests:
          - not_null
      - name: external_ref
        description: "The card expiry year. Format: 4 digits. For example: 2020"
        tests:
          - unique
          - not_null
          - relationships:
              to: ref('stg_globepay__acceptance_report')
              field: external_ref

      - name: chargeback_status
        description: "It is not specified in the API documentation, it always comes TRUE"
        tests:
          - not_null
          - accepted_values:
              values: [ true, false ]

      - name: chargeback_source
        description: "Name of the payment platform, indicates the source that in this source will be GlobePay by default"
        tests:
          - not_null
          - accepted_values:
              values: [ 'GLOBALPAY' ]

      - name: is_chargeback
        description: "Dispute of transaction made in your account and ask your financial institution to reverse the corresponding charge to the merchant or service provider"
        tests:
          - not_null
          - accepted_values:
              values: [ true, false ]